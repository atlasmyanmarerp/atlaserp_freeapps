<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <record id="purchase_order_form_inherit_sl_ngapi" model="ir.ui.view">
        <field name="name">purchase.order.form.inherit.sl.ngapi</field>
        <field name="model">purchase.order</field>
        <field name="inherit_id" ref="purchase.purchase_order_form" />
        <field name="arch" type="xml">
            <div class="oe_title" position="before">
                <div class="oe_title" attrs="{'invisible': [('sl_total_due_warning', '=', False)]}">
                    <h3>
                        <field name="sl_total_due_warning" attrs="{'invisible': [('sl_total_due_warning', '=', False)]}" style='color:Red;'/>
                    </h3>
                </div>
            </div>
            <field name="partner_id" position="after">
                <field name="partner_city" />
                <field name="sl_create_bill" invisible="1" />
                <field name="bill_ok"  />
            </field>
            <button name="action_create_invoice" class="oe_highlight" position="attributes" attrs="{'invisible': ['|', ('state', 'not in', ('purchase', 'done')), ('invoice_status', 'in', ('no', 'invoiced'))]}" data-hotkey="w">
                <attribute name="attrs">{'invisible': [('bill_ok', '=', False),'|','|', ('sl_create_bill', '=', False), ('state', 'not in', ('purchase', 'done')), ('invoice_status', 'in', ('no', 'invoiced'))]}</attribute>
            </button>
            <xpath expr="//field[@name='order_line']//tree//field[@name='product_id']" position="after">
                <field name="sl_product_tag" attrs="{'readonly': [('state', '!=', 'draft')]}" widget="many2many_tags" />
                <field name="total_sold_qty" readonly="1" />
            </xpath>
            <page name="products" position="after">
                <page name="sl_sale_line" string="Sale Line">
                    <field name="sl_sale_line_ids"
                                widget="section_and_note_one2many"
                                mode="tree"
                                readonly="1">
                                <tree string="Sale Order Lines">
                                    <field name="product_id"/>
                                    <field name="product_uom_qty" />
                                    <field name="sl_weight" />
                                    <field name="price_unit" />
                                    <field name="price_subtotal" />
                                </tree>
                    </field>
                </page>
                <page name="sl_so_total_line" string="Total Sale Line">
                    <field name="sl_so_total_line_ids"
                        widget="section_and_note_one2many"
                        mode="tree"
                        readonly="1">
                        <tree string="Total Sale Order Lines">
                            <field name="product_id"/>
                            <field name="origin_weight" />
                            <field name="quantity" />
                            <field name="sl_weight" />
                            <field name="price_unit" />
                            <field name="price_subtotal" />
                        </tree>
                        <form string="Total Sale Order">
                            <sheet>
                                <group>
                                    <field name="product_id"/>
                                    <field name="origin_weight" />
                                    <field name="quantity" />
                                    <field name="sl_weight" />
                                    <field name="price_unit" />
                                    <field name="price_subtotal" />
                                </group>
                            </sheet>
                        </form>
                    </field>
                </page>
            </page>
        </field>
    </record>

</odoo>
